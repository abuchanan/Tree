<!doctype html>
<html
<head>
  <meta charset='utf-8'>
</head>
<body>

<script src='threejs/build/three.js'></script>

<script src="threejs/examples/js/shaders/ConvolutionShader.js"></script>
<script src="threejs/examples/js/shaders/CopyShader.js"></script>
<script src="threejs/examples/js/shaders/FXAAShader.js"></script>

<script src="threejs/examples/js/postprocessing/EffectComposer.js"></script>
<script src="threejs/examples/js/postprocessing/MaskPass.js"></script>
<script src="threejs/examples/js/postprocessing/RenderPass.js"></script>
<script src="threejs/examples/js/postprocessing/ShaderPass.js"></script>
<script src="threejs/examples/js/postprocessing/BloomPass.js"></script>
<script>

var scene = new THREE.Scene();

var camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
camera.position.y = 50;
camera.position.z = 105;

renderer = new THREE.WebGLRenderer({antialias: false});
renderer.setClearColor(0xffffff);
renderer.setSize( window.innerWidth, window.innerHeight );
renderer.autoClear = false;

document.body.appendChild(renderer.domElement);

var effectFXAA, composer;

var renderModel = new THREE.RenderPass( scene, camera );
var effectBloom = new THREE.BloomPass( 1.3 );
var effectCopy = new THREE.ShaderPass( THREE.CopyShader );

effectFXAA = new THREE.ShaderPass( THREE.FXAAShader );

var width = window.innerWidth || 2;
var height = window.innerHeight || 2;

effectFXAA.uniforms[ 'resolution' ].value.set( 1 / width, 1 / height );

effectCopy.renderToScreen = true;

composer = new THREE.EffectComposer( renderer );

composer.addPass( renderModel );
composer.addPass( effectFXAA );
composer.addPass( effectCopy );



var leaf_material = new THREE.MeshLambertMaterial({color: 'green'});
var wood_material = new THREE.MeshLambertMaterial({color: 'brown'})


var tree = new THREE.Object3D();

scene.add(tree);


// Create the trunk

var trunk_height = 100;

var trunk = new THREE.Mesh(new THREE.CylinderGeometry(1, 2, trunk_height, 5, 20, true), wood_material);
trunk.position.y = trunk_height / 2;
tree.add(trunk);

// Add branches

var min_branch_length = 25;
var max_branch_length = 75;
var branch_base_height = 25;
var branch_spacing = 20;
var branch_rotation_offset = Math.PI * .25;
var branch_angle = 0.2;

var leaf_length = 10;
var leaf_spacing = 3;

var leaf_geo = new THREE.CubeGeometry(leaf_length, 0.5, 0.5);
leaf_geo.applyMatrix(new THREE.Matrix4().makeTranslation(leaf_length / 2, 0, 0));

for (var leaf_position = 0; leaf_position < trunk_height; leaf_position += leaf_spacing) {

  for (var a = 0; a <= 2; a += 0.25) {
    var c = new THREE.Mesh(leaf_geo, leaf_material);
    //c.rotation.y = Math.PI * 0.45;
    c.position.y = leaf_position;
    c.rotation.y = Math.PI * a;

    tree.add(c);
  }
}


var axes = new THREE.AxisHelper(50);
axes.position.x = -100;
scene.add(axes);



var l = new THREE.PointLight(0xFFFFFF);
l.position.set(0, 0, 150);
scene.add(l);


function animate() {
  requestAnimationFrame(animate);
  render();
}

function render() {
  renderer.clear();
  composer.render();
}
render();
</script>
</body>
</html>
